class Foto{constructor(){var a=this;this.operationOrgCanvas=document.createElement("canvas"),this.operationOrgCtx=this.operationOrgCanvas.getContext("2d"),this.operationEditedCanvas=document.createElement("canvas"),this.operationEditedCtx=this.operationEditedCanvas.getContext("2d"),this.fileInput=document.getElementById("foto-file"),this.fileInput.addEventListener("change",function(t){a.loadImage()}),this.image=null,this.imageData=null,this.imageWidth=0,this.imageHeight=0,this.convertedToGrayScale=!1,this.redPixelMatrix=[],this.greenPixelMatrix=[],this.bluePixelMatrix=[],this.alphaPixelMatrix=[],this.pickedR="",this.pickedG="",this.pickedB="",this.selectedFileName="",this.selectStart=!1,this.startX="",this.startY="",this.endX="",this.endY="",this.excludeArea=!1}loadImage(){var a=document.getElementById("foto-file");this.selectedFileName=a.files.item(0).name;var t=new FileReader,e=this;t.onload=function(a){e.image=new Image,e.image.onload=function(){e.imageWidth=e.image.width,e.imageHeight=e.image.height,e.operationOrgCanvas.width=e.imageWidth,e.operationOrgCanvas.height=e.imageHeight,e.operationEditedCanvas.width=e.imageWidth,e.operationEditedCanvas.height=e.imageHeight,e.imageData=[],e.redPixelMatrix=[],e.greenPixelMatrix=[],e.bluePixelMatrix=[],e.alphaPixelMatrix=[],e.operationOrgCtx.clearRect(0,0,e.operationOrgCanvas.width,e.operationOrgCanvas.height),e.operationEditedCtx.clearRect(0,0,e.operationEditedCanvas.width,e.operationEditedCanvas.height),e.operationOrgCtx.drawImage(e.image,0,0),e.previewImage(e.operationOrgCanvas),e.imageData=e.operationOrgCtx.getImageData(0,0,e.operationOrgCanvas.width,e.operationOrgCanvas.height);for(var a=[],t=[],i=[],r=[],h=0;h<e.imageData.data.length;h+=4)h/4%e.imageWidth==0&&(0!=h&&(e.redPixelMatrix.push(a),e.greenPixelMatrix.push(t),e.bluePixelMatrix.push(i),e.alphaPixelMatrix.push(r)),a=[],t=[],i=[],r=[]),a.push(e.imageData.data[h]),t.push(e.imageData.data[h+1]),i.push(e.imageData.data[h+2]),r.push(e.imageData.data[h+3]);console.log("Pixel Data Loaded")},e.image.src=a.target.result},t.readAsDataURL(a.files[0])}grayscale(){for(var a=this.imageData,t=0;t<a.data.length;t+=4){var e=a.data[t],i=a.data[t+1],r=a.data[t+2];a.data[t+3];a.data[t]=(e+i+r)/3,a.data[t+1]=(e+i+r)/3,a.data[t+2]=(e+i+r)/3}this.operationEditedCtx.putImageData(a,0,0),this.previewImage(),this.convertedToGrayScale=!this.convertedToGrayScale}makeBright(){for(var a=this.imageData,t=0;t<a.data.length;t+=4){var e=a.data[t],i=a.data[t+1],r=a.data[t+2],h=a.data[t+3];a.data[t]=e+10,a.data[t+1]=i+10,a.data[t+2]=r+10,a.data[t+3]=h}this.operationEditedCtx.putImageData(a,0,0),this.previewImage()}makeDark(){for(var a=this.imageData,t=0;t<a.data.length;t+=4)a.data[t]-=10,a.data[t+1]-=10,a.data[t+2]-=10,a.data[t+3]-=10;this.operationEditedCtx.putImageData(a,0,0),this.previewImage()}makeTransparent(){console.log(this.pickedR);for(var a=this.imageData,t=0;t<a.data.length;t+=4)Math.abs(a.data[t]-this.pickedR)<20&&Math.abs(a.data[t+1]-this.pickedG)<20&&Math.abs(a.data[t+2]-this.pickedB)<20&&(a.data[t+3]=0);this.operationEditedCtx.putImageData(a,0,0),this.previewImage()}applyFilter(a){for(var t=0;t<this.imageData.data.length;t+=4){var e=parseInt(t/4/this.imageWidth),i=t/4%this.imageWidth;if(0!=e&&0!=i&&e!=this.imageHeight-1&&i!=this.imageWidth-1){for(var r=0,h=0,d=0,s=0,o=0;o<3;o++)for(var g=0;g<3;g++)null!=this.redPixelMatrix[e+(o-1)]&&null!=this.redPixelMatrix[e+(o-1)][i+(g-1)]&&(r+=a[o][g]*this.redPixelMatrix[e+(o-1)][i+(g-1)],h+=a[o][g]*this.greenPixelMatrix[e+(o-1)][i+(g-1)],d+=a[o][g]*this.bluePixelMatrix[e+(o-1)][i+(g-1)],s+=a[o][g]*this.alphaPixelMatrix[e+(o-1)][i+(g-1)]);this.convertedToGrayScale?(this.imageData.data[t]=(r+h+d)/3,this.imageData.data[t+1]=(r+h+d)/3,this.imageData.data[t+2]=(r+h+d)/3,this.imageData.data[t+3]=s):(this.imageData.data[t]=r,this.imageData.data[t+1]=h,this.imageData.data[t+2]=d,this.imageData.data[t+3]=s)}}console.log("Its here"),this.operationEditedCtx.putImageData(this.imageData,0,0),this.previewImage()}applyBlurFilter(){this.applyFilter([[.0625,.125,.0625],[.125,.25,.125],[.0625,.125,.0625]])}applyEmbossFilter(){this.applyFilter([[-2,-1,0],[-1,1,1],[0,1,2]])}applySharpFilter(){this.applyFilter([[0,-1,0],[-1,5,-1],[0,-1,0]])}applyCustom(){this.applyFilter([[-1,-1,-1],[2,2,2],[-1,-1,-1]])}export(){var a=document.createElement("a");a.download=this.selectedFileName+"-edited.png",a.href=this.operationEditedCanvas.toDataURL(),a.click()}previewImage(a){var t=document.getElementById("foto-image");t.src=null==a?this.operationEditedCanvas.toDataURL():a.toDataURL()}}